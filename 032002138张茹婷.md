# **一、PSP表格**

|              **PSP2.1**              | **Personal Software  **<br />**Process Stages** | **预估耗时**<br />**（分钟）** | **实际耗时**<br />**（分钟）** |
| :----------------------------------: | :---------------------------------------------: | :----------------------------: | :----------------------------: |
|               Planning               |                      计划                       |               30               |               42               |
|               Estimate               |            估计这个任务需要多少时间             |               3                |               5                |
|             Development              |                      开发                       |               45               |               56               |
|               Analysis               |            需求分析 (包括学习新技术)            |              360               |              645               |
|             Design Spec              |                  生成设计文档                   |               15               |               12               |
|            Design Review             |                    设计复审                     |               10               |               12               |
|           Coding Standard            |      代码规范 (为目前的开发制定合适的规范)      |               10               |               24               |
|                Design                |                    具体设计                     |               45               |               36               |
|                Coding                |                    具体编码                     |              360               |              548               |
|             Code Review              |                    代码复审                     |              120               |              100               |
|                 Test                 |      测试（自我测试，修改代码，提交修改）       |              180               |              300               |
|              Reporting               |                      报告                       |               50               |               72               |
|              Test Repor              |                    测试报告                     |               45               |               48               |
|           Size Measurement           |                   计算工作量                    |               10               |               8                |
| Postmortem & ProcessImprovement Plan |          事后总结, 并提出过程改进计划           |               30               |               25               |
|                                      |                      合计                       |              1272              |              1933              |

# **二、任务要求的实现**

## **（1）项目设计与技术栈**

本次任务主要被拆分成为个环节：基础学习，基本框架构思和设计，程序编写，测验与调试，总结与完成博客，通过使用python语言以及相关工具完成了大部分的程序编写。

1. 基础学习：主要通过b站观看相关视频，以及csdn网站上了解可能用到的函数等。
2. 基本框架构思和设计：通过列出程序实现的基本要素以及各点之间的关系，做出大致的构想
3. 程序编写：主要是通过IDEA，运用python语言完成
4. 测验与调试：通过对比目标网站验证数据提取等问题，不断完善程序
5.   总结与完成博客：在Typora上进行规范markdown文本的书写。

## **（2）爬虫与数据处理**

爬虫程序主体主要是分成四个大类：对于网址的遍历，对于具体页面的爬取，逐一分析以及提取所需数据，导入excel。

1. 网址遍历：网址遍历主要是通过传入url以及对应头部，在主函数中进行循环操作，通过在正确位置添加对应数字标，模拟网站的翻页过程。
2. 具体页面爬取：主要利用了bs4等进行提取和访问，通过find查找关键标签后结合生成对应的具体页面，同时抓取相应的日期，并设置循环操作调用另一个函数进行逐一分析工作，并最终生成总体
3. 逐一分析以及数据提取：主要是通过search在页面内进行关键词查找，并根据查找到的关键词将对应数据提取并存起来。在使用search搜寻结果时，要多加一重判断语句，防止因为页面内不存在对应关键词而造成数据提取出错。在这一部分主要是通过简单遍历实现对各省份的检查，统一存进数组之中，并依靠键值对进行区分。
4. 导入excel：这部分就是使用了基础的xlwings内函数，对于不同省份数据的存储，先进行选择判断当前日期下是否存在对应数据，然后通过直接遍历将数据存入表格之中。

## **（3）数据统计接口部分的性能改进**

使用python -m cProfile data.py在idea终端输出的各函数消耗的部分显示：

![](https://img2022.cnblogs.com/blog/2971600/202209/2971600-20220920091623103-1436386918.png)

## **（4）每日热点的实现思路**

时间不足以及个人能力还有欠缺，只能暂时选择放弃这一版块的实现，但仍有进行相关知识的学习。

## **（5）数据可视化界面的展示**

直接读取爬虫主体中的数组存储数据，实现起来较为麻烦，所以选择了通过读取生成的excel表格，然后进行可视化实现的方向。具体过程中选择了通过pyecharts进行数据可视化的实现，在图样表示上面选择了相对清晰且易于实现的折线图。将新增确诊数据与新增无症状数据分别生成一张页面，而在每一张页面中生成两张图表，将省份结合到一张图中方便对比，同时为了防止过大数据影响，而将本地总数据单独列入另一张图。

# **三、心得体会**

总体来说这是个对我来说相当大的挑战，以前的知识与技能储备对于这一次的任务来说显得有些不够用了。python的很多函数框架都是在任务布置初期进行学习的，编写程序的过程中也在反复的查找与检验，为着各种各样的问题而折腾了很长时间，最终做出来的结果也还有着不少的瑕疵，比如excel的导入耗时较久，每日热点部分没来得及投入实践等。累肯定是会觉得很累的，但总归是在有限的时间里面尽全力做到最好了。