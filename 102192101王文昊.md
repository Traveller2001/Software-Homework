# 一、PSP表格

|                 PSP2.1                  |   Personal Software Process Stages   | 预估耗时（分钟） | 实际耗时（分钟） |
| --------------------------------------- | ------------------------------------ | :-------------: | :-------------: |
| Planning                                | 计划                                 |                 |                 |
| · Estimate                              | · 估计这个任务需要多少时间             |       30        |       30        |
| Development                             | 开发                                 |                 |                 |
| · Analysis                              | · 需求分析 (包括学习新技术)            |       300       |       360       |
| · Design Spec                           | · 生成设计文档                        |       60        |       120      |
| · Design Review                         | · 设计复审                            |       30        |       30        |
| · Coding Standard                       | · 代码规范 (为目前的开发制定合适的规范) |       30        |       30        |
| · Design                                | · 具体设计                            |       100       |       180       |
| · Coding                                | · 具体编码                            |       300       |       390       |
| · Code Review                           | · 代码复审                            |       60        |       60        |
| · Test                                  | · 测试（自我测试，修改代码，提交修改）  |       150       |       150       |
| Reporting                               | 报告                                 |                 |                 |
| · Test Repor                            | · 测试报告                            |       30        |       30        |
| · Size Measurement                      | · 计算工作量                          |       30        |       30        |
| · Postmortem & Process Improvement Plan | · 事后总结, 并提出过程改进计划          |       60        |       60        |
|                                         | · 合计                               |      1200       |      1400       |

# 二、任务要求的实现

- **(3.1)项目设计与技术栈。从阅读完题目到完成作业，这一次的任务被你拆分成了几个环节？你分别通过什么渠道、使用什么方式方法完成了各个环节？列出你完成本次任务所使用的技术栈。（5'）**
  拆分成三个环节，分别为疫情信息的下载和数据提取，信息的数据分析以及疫情地图的可视化绘制。
   通过BeautifulSoup库解析代码，将疫情信息内容下载到本地txt文件用于数据分析使用 ，使用json字符串对省份数据进行提取和显示，使用pyecharts库对疫情地图进行生成。
  
  
- **(3.2)爬虫与数据处理。说明业务逻辑，简述代码的设计过程（例如可介绍有几个类，几个函数，他们之间的关系），并对关键的函数或算法进行说明。（20'）**
**爬虫步骤：**
     发起请求：通过url向服务器发起request请求，请求可以包含额外的header信息。
    获取响应内容：如果服务器正常响应，那我们将会收到一个response，response即为我们所        请求的网页内容，或许包含HTML，Json字符串或者二进制的数据（视频、图片）等。
    解析内容：将Json数据转换成Json对象进行解析
    保存数据：将解析文件保存到本地文件txt中
  ```
  ##下载疫情数据信息
    def dxy_data_down(article_url):
   
    url = urlopen(article_url)
    soup = BeautifulSoup(url, 'html.parser')   # parser解析
    
    f = open("疫情数据1.txt","w",encoding="utf-8")
    f.write(str(soup))
    f.close()

    dxy_data_down("https://ncov.dxy.cn/ncovh5/view/pneumonia")
  ```
  **数据处理：**
  对json字符串进行正则表达式分析，需要json字符串前后关键词，然后对字符串中包含的括号进行转义，最后对json字符串进行正则匹配，获取数据后，我对省份的数据和名称进行整理和地图进行对应。
- **(3.3)数据统计接口部分的性能改进。记录在数据统计接口的性能上所花费的时间，描述你改进的思路，并展示一张性能分析图（例如可通过VS 2019/JProfiler的性能分析工具自动生成），并展示你程序中消耗最大的函数。（6'）**
未进行实验
  

- **(3.4)每日热点的实现思路。简要介绍实现该功能的算法原理，可给出必要的步骤流程图、数学公式推导和核心代码实现，并简要谈谈所采用算法的优缺点与可能的改进方案。（6'）**
爬取每天的新增确诊数量或将今日现存确诊数量和昨日确诊数量进行比较，设定一个阈值，若每日新增大于阈值则为每日热点需要进行重点关注。
  

- **(3.5)数据可视化界面的展示。在博客中介绍数据可视化界面的组件和设计的思路。（15'）**
先对地图中使用的色块颜色进行基础设置
```
#色块初始设置
pieces = [
    {'min': 10000, 'color': '#540d0d'},
    {'max': 9999, 'min': 1000, 'color': '#9c1414'},
    {'max': 999, 'min': 500, 'color': '#d92727'},
    {'max': 499, 'min': 100, 'color': '#ed3232'},
    {'max': 99, 'min': 10, 'color': '#f27777'},
    {'max': 9, 'min': 1, 'color': '#f7adad'},
    {'max': 0, 'color': '#f7e4e4'},
]
```
然后使用pyecharts库对地图进行具体设计
```
#疫情地图设置
Map()
.add(
        series_name="现存确诊", 
        data_pair=data, 
        maptype="china", 
        # 是否默认选中，默认为True
        is_selected=True,
        # 是否启用鼠标滚轮缩放和拖动平移，默认为True
        is_roam=True,
        # 是否显示图形标记，默认为True
        is_map_symbol_show=False
 )
 # 系列配置项
 # 关闭标签名称显示
 .set_series_opts(label_opts=opts.LabelOpts(is_show=True))
 # 全局配置项
 .set_global_opts(
 # 设置标题
 title_opts=opts.TitleOpts(title="中国疫情地图1"),
 # 设置视觉配置项分段显示
 visualmap_opts=opts.VisualMapOpts(
 pieces=pieces,
 is_piecewise=True,
 is_show=True
    )
  )
  ```
# 三、心得体会

- **(4.1)在这儿写下你完成本次作业的心得体会，当然，如果你还有想表达的东西但在上面两个板块没有体现，也可以写在这儿~（10'）**
第一次接触python，在进行项目前利用了一些时间对python爬虫项目做了一些了解，虽然我的代码基础比较薄弱，但好在爬虫项目的整体流程还算比较清楚，python语言也比较言简意赅,但是我在json的处理上遇到了比较大的问题，查找了资料也参考了很多代码最使用了比较笨的方法对文件进行解析和整理。后续又对pyecharts库进行了简单的学习和使用。实验很有收获但是平时事情很多且基础不太好所以参考了一些代码。
  ​	

